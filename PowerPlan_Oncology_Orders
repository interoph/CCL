/*Powerplans, Plan = oncology, orders, os, etc... */
 
 /*begin query*/
SELECT distinct
            POWERPLAN = P.DESCRIPTION
                       ,PowerOrder = o.mnemonic
                       ,PowerOrder_type = uar_get_code_display(o.mnemonic_type_cd)
                       ,Plan_type =  uar_get_code_display(p.pathway_type_cd)

FROM
            PATHWAY_CATALOG   P
            , PATHWAY_COMP   PC
            , ORDER_CATALOG_SYNONYM   O
            , ORDER_CATALOG   OC
            , PW_COMP_OS_RELTN   PCO

PLAN P; 525 plans in BUILD
WHERE P.PATHWAY_CATALOG_ID > 0
and p.active_ind = 1
and P.type_mean = "CAREPLAN" ; <-- powerplan 
;and p.pathway_type_cd = 20584402.00 ; <- need plan type = oncology
and p.description != "zz*"
and p.description != "ZZ*"
and p.description != "test*"

JOIN PC;
WHERE P.PATHWAY_CATALOG_ID = PC.PATHWAY_CATALOG_ID
and pc.parent_entity_id = (select distinct   ; nested query to get around CLOB error when using Distinct upfront
								o.synonym_id
								from
	 							order_catalog_synonym o
								where o.active_ind = 1
								and o.catalog_type_cd = 2516.00
								)

JOIN O
WHERE O.SYNONYM_ID = OUTERJOIN(PC.PARENT_ENTITY_ID)

JOIN OC
WHERE OC.CATALOG_CD = OUTERJOIN(O.CATALOG_CD)

JOIN PCO
WHERE PCO.PATHWAY_COMP_ID = OUTERJOIN(PC.PATHWAY_COMP_ID)


ORDER BY
            P.DESCRIPTION
            , o.mnemonic desc

WITH time = 10

/*end query*/
